### **Техническое задание**

**Проект: «Создание программного средства для автоматической генерации CRUD REST API»

---

### **1. Введение и назначение**

**Бизнес-применение:**
*   **Ускорение разработки:** Сокращение времени на написание шаблонного кода для CRUD-операций, позволяя разработчикам сфокусироваться на бизнес-логике.
*   **Снижение порога входа:** Предоставление возможности аналитикам и проектировщикам систем самостоятельно создавать прототипы API без глубоких знаний в программировании.
*   **Повышение качества кода:** Гарантия генерации унифицированного, чистого и документированного кода, а также базового набора тестов для обеспечения надежности.
*   **Быстрое прототипирование:** Мгновенное создание работающих API для проверки гипотез и демонстрации концепций.

**Ключевое преимущество:**
В отличие от существующих инструментов, средство объединяет три передовых подхода:
1.  **Визуальное проектирование:** Интерактивный веб-интерфейс для drag-and-drop моделирования схемы данных с генерацией кода в реальном времени.
2.  **Интеллектуальная генерация (LLM):** Возможность описать предметную область на естественном языке и получить готовую структуру API.
3.  **Встроенное авто-тестирование:** Автоматическое создание модульных и интеграционных тестов вместе с кодом API, что обеспечивает базовый уровень контроля качества "из коробки".

---

### **2. Проблематика, цели и задачи**

*   **Проблематика:** Ручное написание CRUD API и связанных с ним тестов является рутинной, трудоемкой и подверженной ошибкам задачей, которая отнимает значительную часть времени на старте любого проекта.
*   **Цель:** Повысить эффективность и скорость разработки бэкенд-сервисов, минимизировав ручное кодирование стандартных компонентов.
*   **Задача:** Разработать программное средство, которое автоматизирует полный цикл создания базового REST API: от проектирования моделей данных до генерации кода и набора тестов.

---

### **3. Архитектура и поток работы (Data Flow)**

Платформа будет состоять из трех ключевых модулей:

1.  **Веб-интерфейс (Frontend):**
    *   Предоставляет пользователю **визуальный конструктор моделей данных**. Пользователь перетаскивает сущности, определяет поля (имя, тип данных), устанавливает связи (один-ко-многим, многие-ко-многим).
    *   Содержит текстовое поле для ввода описания предметной области на **естественном языке**.
    *   В реальном времени отображает сгенерированный код и предоставляет опцию для его скачивания.

2.  **Сервер генерации (Backend):**
    *   Принимает данные от веб-интерфейса: либо структурированную схему от визуального конструктора, либо текстовое описание.
    *   **Модуль обработки LLM:** Если получено текстовое описание, оно передается большой языковой модели (LLM), которая анализирует текст и преобразует его в формализованную структуру данных.
    *   **Основной кодогенератор:** На основе полученной структуры генерирует:
        *   Код FastAPI приложения с эндпоинтами для CRUD-операций (Create, Read, Update, Delete).
        *   Pydantic-модели для валидации данных.
        *   Базовую структуру проекта (файлы, директории).
    *   **Генератор тестов:** Параллельно генерирует набор модульных и интеграционных тестов (используя, например, `pytest` и `HTTPX`), покрывающих основные сценарии работы сгенерированного API.

3.  **Поток работы (User Flow):**
    *   Пользователь открывает веб-интерфейс.
    *   **Вариант 1 (Визуальный):** Пользователь проектирует схему базы данных в конструкторе. На каждое его действие (создание таблицы, добавление поля) сервер реагирует и обновляет код, отображаемый на экране.
    *   **Вариант 2 (LLM):** Пользователь пишет в текстовом поле: "Мне нужна система для блога. Должны быть Сущности: 'Пост' с полями 'заголовок', 'содержание', 'дата создания' и 'автор', и 'Автор' с полями 'имя' и 'email'". LLM-модуль обрабатывает запрос и генерирует соответствующую структуру.
    *   Кодогенератор создает FastAPI-проект на основе этой структуры.
    *   Генератор тестов создает файлы с тестами.
    *   Пользователь скачивает готовый к запуску и развертыванию проект в виде zip-архива.

---

### **4. Ключевые технологии**

*   **Язык разработки (Backend):** Python 3.10+
*   **Фреймворк API:** FastAPI
*   **Валидация данных:** Pydantic
*   **Интеллектуальный анализ:** Большая языковая модель.
*   **Фреймворк для тестирования:** Pytest, HTTPX
*   **Веб-интерфейс (Frontend):** React + `react-dnd`.
*   **Среда развертывания:** Docker, Kubernetes.

---

### **5. Функциональные требования (ФТ)**

| ID | Требование | Описание |
| :--- | :--- | :--- |
| **ФТ-1** | **Визуальный конструктор моделей** | Система должна предоставлять веб-интерфейс с возможностью визуального создания моделей данных (сущностей), добавления полей с указанием типов (string, integer, boolean, datetime и т.д.) и установления связей между ними. |
| **ФТ-2** | **Генерация кода в реальном времени** | При любых изменениях в визуальном конструкторе система должна мгновенно обновлять и отображать соответствующий Python-код (Pydantic-модели и эндпоинты FastAPI). |
| **ФТ-3** | **Генерация API на основе LLM** | Система должна принимать описание предметной области на естественном языке (русском/английском) и, используя LLM, генерировать на его основе структуру данных и полный код API. |
| **ФТ-4** | **Генерация CRUD-эндпоинтов** | Для каждой созданной сущности система должна автоматически генерировать 5 стандартных эндпоинтов: создание (POST), чтение одного (GET), чтение списка (GET), обновление (PUT/PATCH) и удаление (DELETE). |
| **ФТ-5** | **Автоматическая генерация тестов** | Система должна генерировать базовый набор модульных и интеграционных тестов для каждого эндпоинта, проверяющих успешное выполнение операций и обработку основных ошибок (например, 404 Not Found). |
| **ФТ-6**| **Поддержка связей между моделями**| Система должна корректно обрабатывать связи (один-ко-многим, многие-ко-многим) и генерировать соответствующие эндпоинты и схемы данных. |
| **ФТ-7**| **Скачивание проекта**| Пользователь должен иметь возможность скачать сгенерированный проект в виде готовой к запуску структуры папок и файлов (zip-архив), включая файл зависимостей (`requirements.txt`). |
| **ФТ-8**| **Документация API**| Сгенерированное FastAPI-приложение должно автоматически поддерживать интерактивную документацию (Swagger UI / ReDoc). |

---

### **6. Нефункциональные требования (НФТ)**

| ID | Требование | Описание |
| :--- | :--- | :--- |
| **НФТ-1** | **Производительность генерации** | Время генерации кода после изменения в конструкторе или отправки текстового запроса (без учета времени ответа LLM) не должно превышать 2 секунд. |
| **НФТ-2** | **Интуитивность интерфейса** | Визуальный конструктор должен быть интуитивно понятным для пользователя, не требующим чтения длинных инструкций. Drag-and-drop функциональность должна работать плавно. |
| **НФТ-3** | **Качество кода** | Сгенерированный код должен соответствовать стандартам PEP 8, быть чистым, читаемым и структурированным. |
| **НФТ-4** | **Расширяемость** | Архитектура кодогенератора должна быть модульной, чтобы в будущем можно было добавлять поддержку других фреймворков или баз данных. |
| **НФТ-5**| **Безопасность**| Веб-приложение не должно хранить данные пользователей или сгенерированный код на сервере дольше, чем это необходимо для сессии пользователя. |
| **НФТ-6** | **Совместимость** | Сгенерированный код должен быть совместим с последними стабильными версиями Python и FastAPI. |
| **НФТ-7** | **Развертывание** | Веб-сервис должен быть контейнеризирован с помощью Docker для простоты развертывания на любом сервере. |

---

### **7. Ограничения и допущения**

*   **Ограничения:**
    *   На первом этапе система генерирует код только для фреймворка **FastAPI**.
    *   В качестве хранилища данных по умолчанию используется **in-memory словарь** или **SQLite** для простоты запуска. Генерация кода для взаимодействия с PostgreSQL/MySQL может быть добавлена на следующих этапах.
    *   Система не генерирует сложную бизнес-логику, только стандартные CRUD-операции.
    *   Операционные системы: веб-интерфейс должен работать в современных браузерах (Chrome, Firefox, Safari, Edge). Сгенерированный код предназначен для запуска в Unix-подобных ОС и Windows.

*   **Допущения:**
    *   Пользователь обладает базовыми знаниями о моделях данных, типах полей и REST API.
    *   Для использования функции генерации на основе LLM предполагается наличие доступа к соответствующему API и ключа для него, который будет настроен в бэкенде.